
alarm_off_loud:
  sequence:
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: !secret xiaomi_gw_mac
        ringtone_id: 10003
        ringtone_vol: 10     
    - service: script.blink_green
    - service: notify.signal
      data_template:
        title: Alarm disarmed ... 
        message: >         
          "Info: Home is <b>not</b> in surveillance."

alarm_on_loud:
  sequence:
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: !secret xiaomi_gw_mac
        ringtone_id: 10002
        ringtone_vol: 10  
    - service: script.blink_orange
    - service: notify.signal
      data_template:
        message: >         
          Info: Home is under surveillance.

alarm_off_silent:
  sequence:
    - service: notify.signal
      data_template:
        message: >         
          Info: Home is not in surveillance.

alarm_on_silent:
  sequence:
    - service: notify.signal
      data_template:
        message: >         
          Info: Home is under surveillance.

smoke_alarm:
  sequence:
    - service: xiaomi_aqara.play_ringtone
      data:
        gw_mac: !secret xiaomi_gw_mac
        ringtone_id: 2
        ringtone_vol: 100
    - service: notify.signal
      data_template:
        message: > 
          Smoke Alarm Triggered...         
          {% if states('binary_sensor.smoke_sensor_158d0001bbe483') == "on" %} 
          Smoke_Sensor_Upstairs
          {% endif %}
          {% if states('binary_sensor.smoke_sensor_158d0001e581ee') == "on" %} 
          Smoke_Sensor_Living
          {% endif %}
          detected a fire !
    - service: homeassistant.turn_on
      entity_id: light.gateway_light_7811dcb8f98a
      data:
        brightness: 255
        rgb_color: [254,0,0]

blink_green:
  sequence:
    - service: script.light_green
    - wait_template: "{{ is_state('script.light_green', 'off') }}"
    - service: script.light_green
    - wait_template: "{{ is_state('script.light_green', 'off') }}"

light_green:
  sequence:
    - service: homeassistant.turn_on
      entity_id: light.gateway_light_7811dcb8f98a
      data:
        brightness: 255
        rgb_color: [0,254,0]
    - delay: 00:00:01
    - service: homeassistant.turn_off
      entity_id: light.gateway_light_7811dcb8f98a
    - delay: 00:00:01

blink_orange:
  sequence:
    - service: script.light_orange
    - wait_template: "{{ is_state('script.light_orange', 'off') }}"
    - service: script.light_orange
    - wait_template: "{{ is_state('script.light_orange', 'off') }}"
    - service: script.light_orange
    - wait_template: "{{ is_state('script.light_orange', 'off') }}"
    - service: script.light_orange
    - wait_template: "{{ is_state('script.light_orange', 'off') }}"   

light_orange:
  sequence:
    - service: homeassistant.turn_on
      entity_id: light.gateway_light_7811dcb8f98a
      data:
        brightness: 255
        rgb_color: [0,0,254]
    - delay: 00:00:01
    - service: homeassistant.turn_off
      entity_id: light.gateway_light_7811dcb8f98a
    - delay: 00:00:01

door_alert:
  sequence:
    - service: notify.signal
      data_template:
        message: >         
          Main door opened !